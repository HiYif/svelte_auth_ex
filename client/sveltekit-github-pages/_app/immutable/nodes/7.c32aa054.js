import{S as xe,i as $e,s as et,k as r,a as m,q as y,P as tt,l as a,h as s,c as h,m as o,r as D,n as t,D as e,b as Se,Q as te,N as ke,O as rt,J as Ye,R as at,H as st,o as ot,T as lt,u as nt,w as it}from"../chunks/index.0a471256.js";import{g as re}from"../chunks/navigation.2579fe60.js";import{p as ct}from"../chunks/stores.11a7e718.js";import{l as dt}from"../chunks/stores.68a1c5e6.js";import{f as ut}from"../chunks/focus.a98a273e.js";import{i as ft,r as mt}from"../chunks/google.2cd10ad3.js";const{document:qe}=lt;function Ze(v){let c,d;return{c(){c=r("p"),d=y(v[1]),this.h()},l(i){c=a(i,"P",{class:!0});var n=o(c);d=D(n,v[1]),n.forEach(s),this.h()},h(){t(c,"class","text-danger")},m(i,n){Se(i,c,n),e(c,d)},p(i,n){n&2&&nt(d,i[1])},d(i){i&&s(c)}}}function ht(v){let c,d,i,n,P,l,A,N,Y,Z,O,_,g,p,k,S,ae,U,C,H,se,oe,V,F,le,ne,b,ie,J,ce,de,w,R,ue,fe,E,me,W,he,ve,z,pe,_e,L,j,ge,Ee,be,we,Ie,$,Q,G,ye,De,K,M,Pe,Ve,Le,u=v[1]&&Ze(v);return{c(){c=r("meta"),d=m(),i=r("div"),n=r("div"),P=r("div"),l=r("form"),A=r("h4"),N=r("strong"),Y=y("Sign In"),Z=m(),O=r("p"),_=y("Welcome back."),g=m(),p=r("div"),k=r("div"),S=r("div"),ae=m(),U=r("div"),C=r("div"),H=r("span"),se=y("or"),oe=m(),V=r("div"),F=r("label"),le=y("Email"),ne=m(),b=r("input"),ie=m(),J=r("div"),ce=y("Email address required"),de=m(),w=r("div"),R=r("label"),ue=y("Password"),fe=m(),E=r("input"),me=m(),W=r("div"),he=y("Password with 8 chars or more required"),ve=m(),z=r("div"),pe=y(`Password minimum length 8, must have one capital letter, 1 number, and one unique
							character.`),_e=m(),L=r("div"),j=r("a"),ge=y("Forgot Password?"),Ee=r("br"),be=m(),we=r("br"),Ie=m(),u&&u.c(),$=m(),Q=r("div"),G=r("button"),ye=y("Sign In"),De=m(),K=r("div"),M=r("a"),Pe=y("Don't have an account?"),this.h()},l(f){const q=tt("svelte-18hoje6",qe.head);c=a(q,"META",{name:!0,content:!0}),q.forEach(s),d=h(f),i=a(f,"DIV",{class:!0});var Te=o(i);n=a(Te,"DIV",{class:!0});var ee=o(n);P=a(ee,"DIV",{class:!0});var Be=o(P);l=a(Be,"FORM",{id:!0,autocomplete:!0});var I=o(l);A=a(I,"H4",{});var Ae=o(A);N=a(Ae,"STRONG",{});var Ne=o(N);Y=D(Ne,"Sign In"),Ne.forEach(s),Ae.forEach(s),Z=h(I),O=a(I,"P",{});var Oe=o(O);_=D(Oe,"Welcome back."),Oe.forEach(s),g=h(I),p=a(I,"DIV",{});var T=o(p);k=a(T,"DIV",{class:!0});var Fe=o(k);S=a(Fe,"DIV",{id:!0}),o(S).forEach(s),Fe.forEach(s),ae=h(T),U=a(T,"DIV",{class:!0});var Re=o(U);C=a(Re,"DIV",{class:!0});var je=o(C);H=a(je,"SPAN",{class:!0});var Ge=o(H);se=D(Ge,"or"),Ge.forEach(s),je.forEach(s),Re.forEach(s),oe=h(T),V=a(T,"DIV",{class:!0});var X=o(V);F=a(X,"LABEL",{class:!0,for:!0});var Me=o(F);le=D(Me,"Email"),Me.forEach(s),ne=h(X),b=a(X,"INPUT",{type:!0,class:!0,placeholder:!0,autocomplete:!0}),ie=h(X),J=a(X,"DIV",{class:!0});var Ue=o(J);ce=D(Ue,"Email address required"),Ue.forEach(s),X.forEach(s),de=h(T),w=a(T,"DIV",{class:!0});var B=o(w);R=a(B,"LABEL",{class:!0,for:!0});var Ce=o(R);ue=D(Ce,"Password"),Ce.forEach(s),fe=h(B),E=a(B,"INPUT",{class:!0,type:!0,minlength:!0,maxlength:!0,placeholder:!0,autocomplete:!0}),me=h(B),W=a(B,"DIV",{class:!0});var He=o(W);he=D(He,"Password with 8 chars or more required"),He.forEach(s),ve=h(B),z=a(B,"DIV",{class:!0});var Je=o(z);pe=D(Je,`Password minimum length 8, must have one capital letter, 1 number, and one unique
							character.`),Je.forEach(s),B.forEach(s),T.forEach(s),_e=h(I),L=a(I,"DIV",{});var x=o(L);j=a(x,"A",{href:!0,class:!0});var We=o(j);ge=D(We,"Forgot Password?"),We.forEach(s),Ee=a(x,"BR",{}),be=h(x),we=a(x,"BR",{}),x.forEach(s),Ie=h(I),u&&u.l(I),$=h(I),Q=a(I,"DIV",{class:!0});var ze=o(Q);G=a(ze,"BUTTON",{class:!0});var Qe=o(G);ye=D(Qe,"Sign In"),Qe.forEach(s),ze.forEach(s),I.forEach(s),Be.forEach(s),De=h(ee),K=a(ee,"DIV",{class:!0});var Ke=o(K);M=a(Ke,"A",{href:!0,class:!0});var Xe=o(M);Pe=D(Xe,"Don't have an account?"),Xe.forEach(s),Ke.forEach(s),ee.forEach(s),Te.forEach(s),this.h()},h(){qe.title="Login Form",t(c,"name","robots"),t(c,"content","noindex, nofollow"),t(S,"id","googleButton"),t(k,"class","mb-1"),t(H,"class","svelte-w3qnyp"),t(C,"class","strike svelte-w3qnyp"),t(U,"class","text-centered"),t(F,"class","form-label"),t(F,"for","email"),t(b,"type","email"),t(b,"class","form-control"),b.required=!0,t(b,"placeholder","Email"),t(b,"autocomplete","email"),t(J,"class","invalid-feedback"),t(V,"class","mb-3"),t(R,"class","form-label"),t(R,"for","password"),t(E,"class","form-control"),t(E,"type","password"),E.required=!0,t(E,"minlength","8"),t(E,"maxlength","80"),t(E,"placeholder","Password"),t(E,"autocomplete","current-password"),t(W,"class","invalid-feedback"),t(z,"class","form-text"),t(w,"class","mb-3"),t(j,"href","/forgot"),t(j,"class","text-black-50"),t(G,"class","btn btn-primary btn-lg"),t(Q,"class","d-grid gap-2"),t(l,"id","signIn"),t(l,"autocomplete","on"),l.noValidate=!0,t(P,"class","card-body svelte-w3qnyp"),t(M,"href","/register"),t(M,"class","text-black-50"),t(K,"class","card-footer text-center bg-white"),t(n,"class","card"),t(i,"class","d-flex justify-content-center mt-5")},m(f,q){e(qe.head,c),Se(f,d,q),Se(f,i,q),e(i,n),e(n,P),e(P,l),e(l,A),e(A,N),e(N,Y),e(l,Z),e(l,O),e(O,_),e(l,g),e(l,p),e(p,k),e(k,S),e(p,ae),e(p,U),e(U,C),e(C,H),e(H,se),e(p,oe),e(p,V),e(V,F),e(F,le),e(V,ne),e(V,b),v[4](b),te(b,v[2].email),e(V,ie),e(V,J),e(J,ce),e(p,de),e(p,w),e(w,R),e(R,ue),e(w,fe),e(w,E),te(E,v[2].password),e(w,me),e(w,W),e(W,he),e(w,ve),e(w,z),e(z,pe),e(l,_e),e(l,L),e(L,j),e(j,ge),e(L,Ee),e(L,be),e(L,we),e(l,Ie),u&&u.m(l,null),e(l,$),e(l,Q),e(Q,G),e(G,ye),e(n,De),e(n,K),e(K,M),e(M,Pe),Ve||(Le=[ke(b,"input",v[5]),ke(E,"input",v[6]),ke(G,"click",rt(v[3]))],Ve=!0)},p(f,[q]){q&4&&b.value!==f[2].email&&te(b,f[2].email),q&4&&E.value!==f[2].password&&te(E,f[2].password),f[1]?u?u.p(f,q):(u=Ze(f),u.c(),u.m(l,$)):u&&(u.d(1),u=null)},i:Ye,o:Ye,d(f){s(c),f&&s(d),f&&s(i),v[4](null),u&&u.d(),Ve=!1,at(Le)}}}function vt(v,c,d){let i;st(v,ct,_=>d(7,i=_));let n,P;const l={email:"",password:""};async function A(){d(1,P="");const _=document.getElementById("signIn");if(_.checkValidity())try{await N(l)}catch(g){g instanceof Error&&(console.error("Login error",g.message),d(1,P=g.message))}else _.classList.add("was-validated"),ut(_)}ot(()=>{ft(),mt(),n.focus()});async function N(_){try{const g=await fetch("/auth/login",{method:"POST",body:JSON.stringify(_),headers:{"Content-Type":"application/json"}}),p=await g.json();if(g.ok){dt.set(p.user);const{role:k}=p.user,S=i.url.searchParams.get("referrer");return S?re(S):k==="teacher"?re("/teachers"):k==="admin"?re("/admin"):re("/")}else throw new Error(p.message)}catch(g){if(g instanceof Error)throw console.error("Login error",g),new Error(g.message)}}function Y(_){it[_?"unshift":"push"](()=>{n=_,d(0,n)})}function Z(){l.email=this.value,d(2,l)}function O(){l.password=this.value,d(2,l)}return[n,P,l,A,Y,Z,O]}class It extends xe{constructor(c){super(),$e(this,c,vt,ht,et,{})}}export{It as component};
